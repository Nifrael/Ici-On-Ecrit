---
import { Image } from "astro:assets";

import Playstation from "@images/mosaïque/Playstation.jpg";
import Nintendo from "@images/mosaïque/Nintendo.jpg";
import Xbox from "@images/mosaïque/Xbox.jpg";
import PC from "@images/mosaïque/PC.jpg";

import People from "@images/mosaïque/People.jpg";
import Society from "@images/mosaïque/Society.jpg";
import Union from "@images/mosaïque/Union.jpg";

import Opinion from "@images/mosaïque/Opinion.jpg";
import Actualités from "@images/mosaïque/Actualités.jpg";
import Journaux from "@images/mosaïque/Journaux.jpg";

const categories = [
  {
    name: "Société",
    slug: "societe",
    images: [People, Society, Union],
  },
  {
    name: "Jeux Vidéo",
    slug: "jeux-video",
    images: [Playstation, Nintendo, Xbox, PC],
  },
  {
    name: "Actualités",
    slug: "actualites",
    images: [Actualités, Journaux, Opinion],
  },
  // {
  //   name: "Art & Culture",
  //   slug: "art-culture",
  //   images: ["/images/art1.jpg", "/images/art2.jpg", "/images/art3.jpg"],
  // },
  // {
  //   name: "Lifestyle",
  //   slug: "lifestyle",
  //   images: [
  //     "/images/lifestyle1.jpg",
  //     "/images/lifestyle2.jpg",
  //     "/images/lifestyle3.jpg",
  //     "/images/lifestyle4.jpg",
  //   ],
  // },
  // {
  //   name: "Science",
  //   slug: "science",
  //   images: [
  //     "/images/science1.jpg",
  //     "/images/science2.jpg",
  //     "/images/science3.jpg",
  //   ],
  // },
];
---

<section class="categories-mozaique">
  <div class="container">
    <h2>Explorez nos catégories</h2>
    <div class="mozaique-grid">
      {
        categories.map((category, index) => (
          <a
            href={`/categories/${category.slug}`}
            class={`category-tile tile-${index + 1} category-${category.slug}`}
          >
            <div class="images-carousel">
              {category.images.map((image, imgIndex) => (
                <Image
                  src={image}
                  alt={`${category.name} ${imgIndex + 1}`}
                  class="carousel-image"
                  width={600}
                  height={400}
                  format="webp"
                  quality={80}
                />
              ))}
            </div>
            <div class="category-overlay">
              <h3>{category.name}</h3>
              <span class="arrow">→</span>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</section>

<style>
  .categories-mozaique {
    padding: 4rem 0;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  h2 {
    text-align: center;
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 3rem;
    color: #1e293b;
  }

  .mozaique-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    grid-template-rows: repeat(3, 200px);
    gap: 1rem;
    height: 620px;
  }

  /* Disposition asymétrique */
  .tile-1 {
    grid-area: 1 / 1 / 3 / 3;
  } /* Grande tuile */
  .tile-2 {
    grid-area: 1 / 3 / 2 / 4;
  }
  .tile-3 {
    grid-area: 1 / 4 / 2 / 5;
  }
  .tile-4 {
    grid-area: 2 / 3 / 4 / 4;
  } /* Tuile haute */
  .tile-5 {
    grid-area: 2 / 4 / 3 / 5;
  }
  .tile-6 {
    grid-area: 3 / 1 / 4 / 3;
  } /* Tuile large */

  .category-tile {
    position: relative;
    border-radius: 1rem;
    overflow: hidden;
    cursor: pointer;
    transition:
      transform 0.3s ease,
      box-shadow 0.3s ease;
    text-decoration: none;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  }

  .category-tile:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
  }

  .images-carousel {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .carousel-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0;
    transition: opacity 1s ease-in-out;
    animation: imageSlide 12s infinite;
  }

  .carousel-image:nth-child(1) {
    animation-delay: 0s;
    opacity: 1;
  }

  .carousel-image:nth-child(2) {
    animation-delay: 3s;
  }

  .carousel-image:nth-child(3) {
    animation-delay: 6s;
  }

  .carousel-image:nth-child(4) {
    animation-delay: 9s;
  }

  .carousel-image:nth-child(5) {
    animation-delay: 12s;
  }

  @keyframes imageSlide {
    0%,
    25% {
      opacity: 1;
    }
    30%,
    100% {
      opacity: 0;
    }
  }

  .category-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    align-items: flex-start;
    padding: 1.5rem;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.7), transparent);
    transition: background 0.3s ease;
  }

  /* Couleurs spécifiques par catégorie */
  .category-jeux-video .category-overlay {
    background: linear-gradient(to top, rgba(239, 68, 68, 0.8), transparent);
  }

  .category-voyage .category-overlay {
    background: linear-gradient(to top, rgba(79, 70, 229, 0.8), transparent);
  }

  .category-technologie .category-overlay {
    background: linear-gradient(to top, rgba(16, 185, 129, 0.8), transparent);
  }

  .category-art-culture .category-overlay {
    background: linear-gradient(to top, rgba(245, 158, 11, 0.8), transparent);
  }

  .category-lifestyle .category-overlay {
    background: linear-gradient(to top, rgba(139, 92, 246, 0.8), transparent);
  }

  .category-science .category-overlay {
    background: linear-gradient(to top, rgba(6, 182, 212, 0.8), transparent);
  }

  .category-tile:hover .category-overlay {
    background: linear-gradient(to top, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.2));
  }

  /* Couleurs au hover spécifiques par catégorie */
  .category-jeux-video:hover .category-overlay {
    background: linear-gradient(
      to top,
      rgba(239, 68, 68, 0.9),
      rgba(239, 68, 68, 0.3)
    );
  }

  .category-voyage:hover .category-overlay {
    background: linear-gradient(
      to top,
      rgba(79, 70, 229, 0.9),
      rgba(79, 70, 229, 0.3)
    );
  }

  .category-technologie:hover .category-overlay {
    background: linear-gradient(
      to top,
      rgba(16, 185, 129, 0.9),
      rgba(16, 185, 129, 0.3)
    );
  }

  .category-art-culture:hover .category-overlay {
    background: linear-gradient(
      to top,
      rgba(245, 158, 11, 0.9),
      rgba(245, 158, 11, 0.3)
    );
  }

  .category-lifestyle:hover .category-overlay {
    background: linear-gradient(
      to top,
      rgba(139, 92, 246, 0.9),
      rgba(139, 92, 246, 0.3)
    );
  }

  .category-science:hover .category-overlay {
    background: linear-gradient(
      to top,
      rgba(6, 182, 212, 0.9),
      rgba(6, 182, 212, 0.3)
    );
  }

  .category-overlay h3 {
    color: white;
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    transform: translateY(0);
    transition: transform 0.3s ease;
  }

  .category-tile:hover .category-overlay h3 {
    transform: translateY(-4px);
  }

  .arrow {
    color: white;
    font-size: 1.5rem;
    font-weight: bold;
    opacity: 0;
    transform: translateX(-10px);
    transition: all 0.3s ease;
  }

  .category-tile:hover .arrow {
    opacity: 1;
    transform: translateX(0);
  }

  /* Responsive */
  @media (max-width: 968px) {
    .mozaique-grid {
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(3, 180px);
      height: auto;
    }

    .tile-1 {
      grid-area: 1 / 1 / 2 / 2;
    }
    .tile-2 {
      grid-area: 1 / 2 / 2 / 3;
    }
    .tile-3 {
      grid-area: 2 / 1 / 3 / 2;
    }
    .tile-4 {
      grid-area: 2 / 2 / 3 / 3;
    }
    .tile-5 {
      grid-area: 3 / 1 / 4 / 2;
    }
    .tile-6 {
      grid-area: 3 / 2 / 4 / 3;
    }
  }

  @media (max-width: 640px) {
    .container {
      padding: 0 1rem;
    }

    h2 {
      font-size: 2rem;
      margin-bottom: 2rem;
    }

    .mozaique-grid {
      grid-template-columns: 1fr;
      grid-template-rows: repeat(6, 160px);
    }

    .tile-1,
    .tile-2,
    .tile-3,
    .tile-4,
    .tile-5,
    .tile-6 {
      grid-area: auto;
    }

    .category-overlay {
      padding: 1rem;
    }

    .category-overlay h3 {
      font-size: 1.25rem;
    }
  }
</style>

<script>
  // Amélioration de l'animation pour une meilleure performance
  document.addEventListener("DOMContentLoaded", () => {
    const tiles = document.querySelectorAll(".category-tile");

    // Intersection Observer pour déclencher les animations seulement quand visible
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("animate");
          }
        });
      },
      { threshold: 0.1 },
    );

    tiles.forEach((tile) => observer.observe(tile));
  });
</script>
